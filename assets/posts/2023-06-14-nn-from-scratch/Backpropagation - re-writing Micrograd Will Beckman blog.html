<!DOCTYPE html>
<html lang="en"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Backpropagation - re-writing Micrograd | Will Beckman blog</title>
<meta name="generator" content="Jekyll v3.9.3">
<meta property="og:title" content="Backpropagation - re-writing Micrograd">
<meta property="og:locale" content="en_US">
<meta name="description" content="Posting publicly, but mostly archiving for my future self to revisit.">
<meta property="og:description" content="Posting publicly, but mostly archiving for my future self to revisit.">
<link rel="canonical" href="http://localhost:4000/backprop.html">
<meta property="og:url" content="http://localhost:4000/backprop.html">
<meta property="og:site_name" content="Will Beckman blog">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2023-05-17T12:00:00-04:00">
<meta name="twitter:card" content="summary">
<meta property="twitter:title" content="Backpropagation - re-writing Micrograd">
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-05-17T12:00:00-04:00","datePublished":"2023-05-17T12:00:00-04:00","description":"Posting publicly, but mostly archiving for my future self to revisit.","headline":"Backpropagation - re-writing Micrograd","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/backprop.html"},"url":"http://localhost:4000/backprop.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="Backpropagation%20-%20re-writing%20Micrograd%20Will%20Beckman%20blog_files/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Will Beckman blog"><!-- for mathjax support -->
  
  <script type="text/x-mathjax-config;executed=true">
    MathJax.Hub.Config({
    TeX: { equationNumbers: { autoNumber: "AMS" } }
    });
  </script>
  <script src="Backpropagation%20-%20re-writing%20Micrograd%20Will%20Beckman%20blog_files/MathJax.js" id=""></script>
  
  
<style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1px; bottom: 2px; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax.MathJax_FullWidth {text-align: center; display: table-cell!important; width: 10000em!important}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax_LineBox {display: table!important}
.MathJax_LineBox span {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Blank; src: url('about:blank')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head>
<body><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px none; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="http://localhost:4000/">Will Beckman blog</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger">
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"></path>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="http://localhost:4000/">Home</a><a class="page-link" href="http://localhost:4000/about/">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope="" itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Backpropagation - re-writing Micrograd</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2023-05-17T12:00:00-04:00" itemprop="datePublished">May 17, 2023
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <center><img src="Backpropagation%20-%20re-writing%20Micrograd%20Will%20Beckman%20blog_files/neural_net.png"></center>

<p><br></p>

<p style="text-align: center;">The code associated with this blog post can be found 
<a target="_blank" href="https://github.com/wbeckman/micrograd-without-looking">here</a>.</p>

<p><br></p>

<h1 id="table-of-contents">Table of Contents</h1>
<ul>
  <li><a href="#table-of-contents">Table of Contents</a>
    <ul>
      <li><a href="#background">Background</a></li>
      <li><a href="#neural-networks">Neural Networks</a></li>
      <li><a href="#computational-graphs">Computational graphs</a>
        <ul>
          <li><a href="#what-is-a-computational-graph">What is a computational graph?</a></li>
          <li><a href="#representing-simple-neural-networks-as-a-computational-graph">Representing (Simple) Neural Networks as a Computational Graph</a></li>
        </ul>
      </li>
      <li><a href="#calculus">Calculus</a>
        <ul>
          <li><a href="#derivatives-for-a-simple-feedforward-network">Derivatives for a Simple Feedforward Network</a></li>
          <li><a href="#chain-rule">Chain rule</a></li>
        </ul>
      </li>
      <li><a href="#gradients-on-a-computational-graph">Gradients on a Computational Graph</a>
        <ul>
          <li><a href="#the-trivial-case">The Trivial Case</a></li>
          <li><a href="#backpropagation">Backpropagation</a></li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<p><br></p>

<hr>

<p><br></p>

<h2 id="background">Background</h2>

<p>In an attempt to refamiliarize myself with the backpropagation 
algorithm (i.e. “backprop”), I re-wrote an autograd library written by 
Andrej Karpathy called “<a href="https://github.com/karpathy/micrograd" target="_blank">micrograd</a>”, and (almost successfully) managed to do so without looking. Micrograd runs <em><a href="https://en.wikipedia.org/wiki/Automatic_differentiation#Reverse_accumulation" target="_blank">reverse-mode automatic-differentiation</a> (auto-diff) to compute gradients for a computational graph</em>. Since a neural network is a <em>special case</em> of a computational graph, backprop is a <em>special case</em>
 of reverse-mode auto-diff when it is applied to a neural network. If 
this sounds confusing, read on, and I will break this all down step-by 
step.</p>

<p>You will need a bit of calculus knowledge of elementary derivatives 
and the chain rule to understand this. If you have previously studied 
calculus but need a refresher, this post should get you up to speed on 
what you need to remember. There’s, unfortunately, no way to make a post
 about backpropagation short, but I have provided a table of contents so
 you can skim/skip sections that you’re already familiar with.</p>

<p>This is an informal post that  will use small amounts of formal math 
notation, but I will try in keep it to a minimum. In places where math 
notation could be used, I prefer visuals and code.</p>

<p>If you somehow showed up here without having seen Karpathy’s original video, I highly recommend you check out the original <a href="https://www.youtube.com/watch?v=VMj-3S1tku0&amp;list=PLAqhIrjkxbuWI23v9cThsA9GvCAUhRvKZ&amp;index=2" target="_blank">here</a>.</p>

<p><br></p>

<hr>

<p><br></p>

<h2 id="neural-networks">Neural Networks</h2>

<p>If you aren’t familiar with why neural networks are a big deal, I 
could write thousands of words on that, but I will spare you. Neural 
networks are non-linear function approximators that can theoretically 
approximate <a href="https://en.wikipedia.org/wiki/Universal_approximation_theorem" target="_blank">any continuous function</a>.
 They can be used to model statistical co-occurrences of words (as in 
large language models), they can be used to model co-occurrences of 
image pixels (as in image segmentation/detection/classification models),
 they can be used to help recommend content on a website (via content 
embeddings), and they are an important component of systems that can 
play games at superhuman levels (as in deep reinforcement learning). 
Each of these things are extremely cool in their own right and deserve a
 blog post of their own, but this post is going low-level in how neural 
networks are trained.</p>

<center>
<p>
    <video autoplay="autoplay" loop="" muted="muted" width="300" height="200">
      <source src="Backpropagation%20-%20re-writing%20Micrograd%20Will%20Beckman%20blog_files/lunar-lander-trimmed.mp4" type="video/mp4">
    </video> 

</p>
<p>
  <em>Maybe not... superhuman performance... but a moderately smart 
reinforcement learning agent I trained for class using a deep Q-network 
with experience replay.</em>
</p>
</center>

<p>The most amazing thing about neural networks to me, however, is that they are all trained with <em>a single algorithm</em>. As you might have guessed, that algorithm is <em>backpropagation</em>.
 GPT-4 is trained using backpropagation. All sorts of generative AI 
(e.g. stable diffusion, midjourney) are trained with backpropagation. 
Even local image explanations in the emerging field of explainable AI 
are produced using backpropagation (on the <em>input pixels</em> of the 
image instead of the network weights). It’s not an exaggeration to say 
that recently, backpropagation has become one of the most important 
algorithms in the world.</p>

<p>So in brief: neural networks are function approximators that take an 
input X and produce a predicted output Y that attempts to model a true 
distribution of the input data. There is a training procedure called 
backpropagation that iteratively drives the neural network’s 
approximation closer to the true function it is trying to approximate. 
The data the network is fed, the <em>architecture</em>, and the <em>loss function</em>
 of a neural network primarily govern how it behaves. If any of this is 
confusing to you, you might want to brush up on how neural networks work
 with a supplemental resource like <a href="https://www.youtube.com/watch?v=aircAruvnKk" target="_blank">3blue1brown</a>. Otherwise, lets discuss computational graphs.</p>

<p><br></p>

<hr>

<p><br></p>

<h2 id="computational-graphs">Computational graphs</h2>

<h3 id="what-is-a-computational-graph">What is a computational graph?</h3>

<p>A <em>computational graph</em> is a directed acyclic graph (DAG) in which nodes correspond to either <em>variables</em> or <em>operations</em>. The simplest computational graph might look as follows:</p>

<center>
<p>
    <img src="Backpropagation%20-%20re-writing%20Micrograd%20Will%20Beckman%20blog_files/computational_graph.png" alt="">
</p>
<p>
    <em>A computational graph in its simplest form - two variables - a=1
 and b=2 being multipled to produce a third value, c=2. The code to 
generate these visuals was adapted from Karpathy's code in Micrograd.</em>
</p>
</center>

<p>While this is a very simple example of a computational graph, it’s a 
step in the right direction for what we need for a forward pass in a 
neural network. It might help to show what a single neuron activation 
looks like in a computational graph and compare it to the more “classic”
 representation of a neural network.</p>

<h3 id="representing-simple-neural-networks-as-a-computational-graph">Representing (Simple) Neural Networks as a Computational Graph</h3>

<p>You have probably seen a traditional view of a neural network as a 
bunch of tangled lines between nodes. While this is a compact way to 
represent neural networks visually, for the purposes of backpropagation,
 it’s much better to think of the network as a computational graph.</p>

<p>Let’s pretend that we have a very, very small neural network with two
 inputs, two hidden nodes, and a single output. Let’s also pretend that 
we have just computed the activation for a single neuron in the hidden 
layer, h1. In the graph, we will assume dark gray nodes have triggered 
as of the present time and light gray nodes have not yet triggered.  
Here’s what the traditional view of this might look like:</p>

<center>
<p>
    <img src="Backpropagation%20-%20re-writing%20Micrograd%20Will%20Beckman%20blog_files/single_neuron.png" alt="">
</p>
<p>
    <em>A neural network in which we have just computed</em><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 12.041em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.836em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.725em, 1009.79em, 2.892em, -1000em); top: -2.561em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="msubsup" id="MathJax-Span-3"><span style="display: inline-block; position: relative; width: 0.929em; height: 0px;"><span style="position: absolute; clip: rect(3.159em, 1000.48em, 4.159em, -1000em); top: -3.996em; left: 0em;"><span class="mi" id="MathJax-Span-4" style="font-family: STIXGeneral; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; top: -3.846em; left: 0.5em;"><span class="mn" id="MathJax-Span-5" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span></span></span><span class="mo" id="MathJax-Span-6" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-7" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.313em;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.018em;"></span></span><span class="mi" id="MathJax-Span-8" style="font-family: STIXGeneral; font-style: italic;">a</span><span class="mi" id="MathJax-Span-9" style="font-family: STIXGeneral; font-style: italic;">n</span><span class="mi" id="MathJax-Span-10" style="font-family: STIXGeneral; font-style: italic;">h</span><span class="mo" id="MathJax-Span-11" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-12"><span style="display: inline-block; position: relative; width: 0.873em; height: 0px;"><span style="position: absolute; clip: rect(3.401em, 1000.45em, 4.161em, -1000em); top: -3.996em; left: 0em;"><span class="mi" id="MathJax-Span-13" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; top: -3.846em; left: 0.444em;"><span class="mn" id="MathJax-Span-14" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-15"><span style="display: inline-block; position: relative; width: 1.096em; height: 0px;"><span style="position: absolute; clip: rect(3.401em, 1000.65em, 4.168em, -1000em); top: -3.996em; left: 0em;"><span class="mi" id="MathJax-Span-16" style="font-family: STIXGeneral; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; top: -3.846em; left: 0.667em;"><span class="mn" id="MathJax-Span-17" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span></span></span><span class="mo" id="MathJax-Span-18" style="font-family: STIXGeneral; padding-left: 0.25em;">+</span><span class="msubsup" id="MathJax-Span-19" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 0.873em; height: 0px;"><span style="position: absolute; clip: rect(3.401em, 1000.45em, 4.161em, -1000em); top: -3.996em; left: 0em;"><span class="mi" id="MathJax-Span-20" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; top: -3.846em; left: 0.444em;"><span class="mn" id="MathJax-Span-21" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-22"><span style="display: inline-block; position: relative; width: 1.096em; height: 0px;"><span style="position: absolute; clip: rect(3.401em, 1000.65em, 4.168em, -1000em); top: -3.996em; left: 0em;"><span class="mi" id="MathJax-Span-23" style="font-family: STIXGeneral; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; top: -3.846em; left: 0.667em;"><span class="mn" id="MathJax-Span-24" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span></span></span><span class="mo" id="MathJax-Span-25" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 2.561em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.278em; border-left: 0px solid; width: 0px; height: 1.174em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>h</mi><mn>1</mn></msub><mo>=</mo><mi>t</mi><mi>a</mi><mi>n</mi><mi>h</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><msub><mi>w</mi><mn>1</mn></msub><mo>+</mo><msub><mi>x</mi><mn>2</mn></msub><msub><mi>w</mi><mn>2</mn></msub><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-1">h_1=tanh(x_1w_1+x_2w_2)</script> 
</p>
</center>

<p>The equivalent computational graph, representing just <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-26" style="width: 1.283em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.025em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.725em, 1000.92em, 2.724em, -1000em); top: -2.561em; left: 0em;"><span class="mrow" id="MathJax-Span-27"><span class="mi" id="MathJax-Span-28" style="font-family: STIXGeneral; font-style: italic;">h</span><span class="mn" id="MathJax-Span-29" style="font-family: STIXGeneral;">1</span></span><span style="display: inline-block; width: 0px; height: 2.561em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 0.969em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>h</mi><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-2">h1</script>’s activation, would look as follows:</p>

<center><img src="Backpropagation%20-%20re-writing%20Micrograd%20Will%20Beckman%20blog_files/single_neuron_comp_graph_final.png" alt=""></center>

<p>While the computational graph view is a lot less… terse… it makes 
explicit a number of details that the traditional view of neural 
networks obscure. For example, you can see, step-by-step, the process of
 computing a neuron’s activation:</p>

<ol>
  <li>Multiply the inputs by the neuron’s weights (<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-30" style="width: 10.812em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.863em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.949em, 1008.86em, 2.865em, -1000em); top: -2.561em; left: 0em;"><span class="mrow" id="MathJax-Span-31"><span class="msubsup" id="MathJax-Span-32"><span style="display: inline-block; position: relative; width: 0.929em; height: 0px;"><span style="position: absolute; clip: rect(3.401em, 1000.47em, 4.161em, -1000em); top: -3.996em; left: 0em;"><span class="mi" id="MathJax-Span-33" style="font-family: STIXGeneral; font-style: italic;">o</span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; top: -3.846em; left: 0.5em;"><span class="mn" id="MathJax-Span-34" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span></span></span><span class="mo" id="MathJax-Span-35" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-36" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.096em; height: 0px;"><span style="position: absolute; clip: rect(3.401em, 1000.65em, 4.168em, -1000em); top: -3.996em; left: 0em;"><span class="mi" id="MathJax-Span-37" style="font-family: STIXGeneral; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; top: -3.846em; left: 0.667em;"><span class="mn" id="MathJax-Span-38" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-39"><span style="display: inline-block; position: relative; width: 0.873em; height: 0px;"><span style="position: absolute; clip: rect(3.401em, 1000.45em, 4.161em, -1000em); top: -3.996em; left: 0em;"><span class="mi" id="MathJax-Span-40" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; top: -3.846em; left: 0.444em;"><span class="mn" id="MathJax-Span-41" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span></span></span><span class="mo" id="MathJax-Span-42" style="font-family: STIXGeneral;">;</span><span class="msubsup" id="MathJax-Span-43" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.929em; height: 0px;"><span style="position: absolute; clip: rect(3.401em, 1000.47em, 4.161em, -1000em); top: -3.996em; left: 0em;"><span class="mi" id="MathJax-Span-44" style="font-family: STIXGeneral; font-style: italic;">o</span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; top: -3.846em; left: 0.5em;"><span class="mn" id="MathJax-Span-45" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span></span></span><span class="mo" id="MathJax-Span-46" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-47" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.096em; height: 0px;"><span style="position: absolute; clip: rect(3.401em, 1000.65em, 4.168em, -1000em); top: -3.996em; left: 0em;"><span class="mi" id="MathJax-Span-48" style="font-family: STIXGeneral; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; top: -3.846em; left: 0.667em;"><span class="mn" id="MathJax-Span-49" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-50"><span style="display: inline-block; position: relative; width: 0.873em; height: 0px;"><span style="position: absolute; clip: rect(3.401em, 1000.45em, 4.161em, -1000em); top: -3.996em; left: 0em;"><span class="mi" id="MathJax-Span-51" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; top: -3.846em; left: 0.444em;"><span class="mn" id="MathJax-Span-52" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.561em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.245em; border-left: 0px solid; width: 0px; height: 0.868em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>o</mi><mn>1</mn></msub><mo>=</mo><msub><mi>w</mi><mn>1</mn></msub><msub><mi>x</mi><mn>1</mn></msub><mo>;</mo><msub><mi>o</mi><mn>2</mn></msub><mo>=</mo><msub><mi>w</mi><mn>2</mn></msub><msub><mi>x</mi><mn>2</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-3">o_1=w_1x_1; o_2=w_2x_2</script>)</li>
  <li>Sum all of the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-53" style="width: 1.386em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.127em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.967em, 1001.13em, 2.733em, -1000em); top: -2.561em; left: 0em;"><span class="mrow" id="MathJax-Span-54"><span class="mi" id="MathJax-Span-55" style="font-family: STIXGeneral; font-style: italic;">w</span><span class="mi" id="MathJax-Span-56" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.561em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.084em; border-left: 0px solid; width: 0px; height: 0.685em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-4">wx</script> terms (<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-57" style="width: 6.457em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.277em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.725em, 1005.28em, 2.865em, -1000em); top: -2.561em; left: 0em;"><span class="mrow" id="MathJax-Span-58"><span class="msubsup" id="MathJax-Span-59"><span style="display: inline-block; position: relative; width: 0.929em; height: 0px;"><span style="position: absolute; clip: rect(3.159em, 1000.48em, 4.159em, -1000em); top: -3.996em; left: 0em;"><span class="mi" id="MathJax-Span-60" style="font-family: STIXGeneral; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; top: -3.846em; left: 0.5em;"><span class="mn" id="MathJax-Span-61" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span></span></span><span class="mo" id="MathJax-Span-62" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-63" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 0.929em; height: 0px;"><span style="position: absolute; clip: rect(3.401em, 1000.47em, 4.161em, -1000em); top: -3.996em; left: 0em;"><span class="mi" id="MathJax-Span-64" style="font-family: STIXGeneral; font-style: italic;">o</span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; top: -3.846em; left: 0.5em;"><span class="mn" id="MathJax-Span-65" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span></span></span><span class="mo" id="MathJax-Span-66" style="font-family: STIXGeneral; padding-left: 0.25em;">+</span><span class="msubsup" id="MathJax-Span-67" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 0.929em; height: 0px;"><span style="position: absolute; clip: rect(3.401em, 1000.47em, 4.161em, -1000em); top: -3.996em; left: 0em;"><span class="mi" id="MathJax-Span-68" style="font-family: STIXGeneral; font-style: italic;">o</span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; top: -3.846em; left: 0.5em;"><span class="mn" id="MathJax-Span-69" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.561em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.245em; border-left: 0px solid; width: 0px; height: 1.141em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>h</mi><mn>1</mn></msub><mo>=</mo><msub><mi>o</mi><mn>1</mn></msub><mo>+</mo><msub><mi>o</mi><mn>2</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-5">h_1=o_1+o_2</script>)</li>
  <li>Compute the activation for <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-70" style="width: 1.283em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.025em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.725em, 1000.92em, 2.724em, -1000em); top: -2.561em; left: 0em;"><span class="mrow" id="MathJax-Span-71"><span class="mi" id="MathJax-Span-72" style="font-family: STIXGeneral; font-style: italic;">h</span><span class="mn" id="MathJax-Span-73" style="font-family: STIXGeneral;">1</span></span><span style="display: inline-block; width: 0px; height: 2.561em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 0.969em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>h</mi><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-6">h1</script> (<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x005F;&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-74" style="width: 12.912em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.553em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.725em, 1010.51em, 2.892em, -1000em); top: -2.561em; left: 0em;"><span class="mrow" id="MathJax-Span-75"><span class="msubsup" id="MathJax-Span-76"><span style="display: inline-block; position: relative; width: 0.929em; height: 0px;"><span style="position: absolute; clip: rect(3.159em, 1000.48em, 4.159em, -1000em); top: -3.996em; left: 0em;"><span class="mi" id="MathJax-Span-77" style="font-family: STIXGeneral; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; top: -3.846em; left: 0.5em;"><span class="mn" id="MathJax-Span-78" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span></span></span><span class="mi" id="MathJax-Span-79" style="font-family: STIXGeneral;">_</span><span class="mi" id="MathJax-Span-80" style="font-family: STIXGeneral; font-style: italic;">a</span><span class="mi" id="MathJax-Span-81" style="font-family: STIXGeneral; font-style: italic;">c</span><span class="mi" id="MathJax-Span-82" style="font-family: STIXGeneral; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.018em;"></span></span><span class="mi" id="MathJax-Span-83" style="font-family: STIXGeneral; font-style: italic;">i</span><span class="mi" id="MathJax-Span-84" style="font-family: STIXGeneral; font-style: italic;">v</span><span class="mi" id="MathJax-Span-85" style="font-family: STIXGeneral; font-style: italic;">a</span><span class="mi" id="MathJax-Span-86" style="font-family: STIXGeneral; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.018em;"></span></span><span class="mi" id="MathJax-Span-87" style="font-family: STIXGeneral; font-style: italic;">i</span><span class="mi" id="MathJax-Span-88" style="font-family: STIXGeneral; font-style: italic;">o</span><span class="mi" id="MathJax-Span-89" style="font-family: STIXGeneral; font-style: italic;">n</span><span class="mo" id="MathJax-Span-90" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-91" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.313em;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.018em;"></span></span><span class="mi" id="MathJax-Span-92" style="font-family: STIXGeneral; font-style: italic;">a</span><span class="mi" id="MathJax-Span-93" style="font-family: STIXGeneral; font-style: italic;">n</span><span class="mi" id="MathJax-Span-94" style="font-family: STIXGeneral; font-style: italic;">h</span><span class="mo" id="MathJax-Span-95" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-96" style="font-family: STIXGeneral; font-style: italic;">h</span><span class="mn" id="MathJax-Span-97" style="font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-98" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-99" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 2.561em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.278em; border-left: 0px solid; width: 0px; height: 1.174em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>h</mi><mn>1</mn></msub><mi mathvariant="normal">_</mi><mi>a</mi><mi>c</mi><mi>t</mi><mi>i</mi><mi>v</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mo>=</mo><mi>t</mi><mi>a</mi><mi>n</mi><mi>h</mi><mo stretchy="false">(</mo><mi>h</mi><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-7">h_1\_activation=tanh(h1))</script></li>
</ol>

<p>It’s unclear that all of this is happening in the first view. More 
importantly, the computational graph allows us to show what the data 
(and the gradients, but more on that later) are at each step of the way.
 You can imagine that if this is one neuron (h1), all the other neurons 
in a hidden layer (in this case, h2) fire the same way with different 
weights. Now that you have seen how computational graphs can represent 
neural networks, we’re going to put this on hold for a second and take a
 trip back to Calc 1.</p>

<p><br></p>

<hr>

<p><br></p>

<h2 id="calculus">Calculus</h2>

<p>Because we want to find out how we can change the weights of a neural
 network to make its performance improve, we will need to calculate the 
gradient of the weights with respect to some sort of performance 
measurement (known as the loss). You will need to know a few elementary 
derivatives and have an intuitive grasp of the chain rule to understand 
how backpropagation works. Both of those things will be covered in brief
 here.</p>

<h3 id="derivatives-for-a-simple-feedforward-network">Derivatives for a Simple Feedforward Network</h3>

<p>For this tutorial, we are considering a feedforward neural network 
with one input layer (i.e. data), a hidden layer, and an output layer. 
The derivatives that you need to know for this network are: addition, 
multiplication, tanh, and the power function. The derivatives for these 
are as follows:</p>

<p><strong>Addition</strong></p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-100" style="width: 7.072em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.789em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.73em, 1005.77em, 2.922em, -1000em); top: -2.561em; left: 0em;"><span class="mrow" id="MathJax-Span-101"><span class="mi" id="MathJax-Span-102" style="font-family: STIXGeneral; font-style: italic; text-rendering: optimizelegibility;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span class="mo" id="MathJax-Span-103" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-104" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-105" style="font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-106" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.188em;">y</span><span class="mo" id="MathJax-Span-107" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-108" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-109" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.313em;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-110" style="font-family: STIXGeneral; padding-left: 0.25em;">+</span><span class="mi" id="MathJax-Span-111" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.25em;">y</span></span><span style="display: inline-block; width: 0px; height: 2.561em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.315em; border-left: 0px solid; width: 0px; height: 1.205em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mi>x</mi><mo>+</mo><mi>y</mi></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-8">f(x, y)=x+y</script>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;;&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-112" style="width: 8.148em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.66em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.053em, 1006.55em, 3.607em, -1000em); top: -2.561em; left: 0em;"><span class="mrow" id="MathJax-Span-113"><span class="mfrac" id="MathJax-Span-114"><span style="display: inline-block; position: relative; width: 1.038em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.164em, 1000.9em, 4.357em, -1000em); top: -4.672em; left: 50%; margin-left: -0.448em;"><span class="mrow" id="MathJax-Span-115"><span class="mi" id="MathJax-Span-116" style="font-family: STIXGeneral;">∂</span><span class="mi" id="MathJax-Span-117" style="font-family: STIXGeneral; font-style: italic; text-rendering: optimizelegibility;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; clip: rect(3.174em, 1000.92em, 4.161em, -1000em); top: -3.31em; left: 50%; margin-left: -0.459em;"><span class="mrow" id="MathJax-Span-118"><span class="mi" id="MathJax-Span-119" style="font-family: STIXGeneral;">∂</span><span class="mi" id="MathJax-Span-120" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; clip: rect(0.858em, 1001.04em, 1.23em, -1000em); top: -1.296em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.038em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.076em;"></span></span></span></span><span class="mo" id="MathJax-Span-121" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="mn" id="MathJax-Span-122" style="font-family: STIXGeneral; padding-left: 0.313em;">1</span><span class="mo" id="MathJax-Span-123" style="font-family: STIXGeneral;">;</span><span class="mfrac" id="MathJax-Span-124" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.035em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.164em, 1000.9em, 4.357em, -1000em); top: -4.672em; left: 50%; margin-left: -0.448em;"><span class="mrow" id="MathJax-Span-125"><span class="mi" id="MathJax-Span-126" style="font-family: STIXGeneral;">∂</span><span class="mi" id="MathJax-Span-127" style="font-family: STIXGeneral; font-style: italic; text-rendering: optimizelegibility;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; clip: rect(3.174em, 1000.9em, 4.356em, -1000em); top: -3.31em; left: 50%; margin-left: -0.458em;"><span class="mrow" id="MathJax-Span-128"><span class="mi" id="MathJax-Span-129" style="font-family: STIXGeneral;">∂</span><span class="mi" id="MathJax-Span-130" style="font-family: STIXGeneral; font-style: italic;">y</span></span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; clip: rect(0.858em, 1001.04em, 1.23em, -1000em); top: -1.296em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.035em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.076em;"></span></span></span></span><span class="mo" id="MathJax-Span-131" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="mn" id="MathJax-Span-132" style="font-family: STIXGeneral; padding-left: 0.313em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.561em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.151em; border-left: 0px solid; width: 0px; height: 2.866em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>f</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow></mfrac><mo>=</mo><mn>1</mn><mo>;</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>f</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>y</mi></mrow></mfrac><mo>=</mo><mn>1</mn></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-9">\frac{\partial f}{\partial x}=1; \frac{\partial f}{\partial y}=1</script>

<p><strong>Multiplication</strong>:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-133" style="width: 5.638em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.611em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.73em, 1004.59em, 2.922em, -1000em); top: -2.561em; left: 0em;"><span class="mrow" id="MathJax-Span-134"><span class="mi" id="MathJax-Span-135" style="font-family: STIXGeneral; font-style: italic; text-rendering: optimizelegibility;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span class="mo" id="MathJax-Span-136" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-137" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-138" style="font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-139" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.188em;">y</span><span class="mo" id="MathJax-Span-140" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-141" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-142" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.313em;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-143" style="font-family: STIXGeneral; font-style: italic;">y</span></span><span style="display: inline-block; width: 0px; height: 2.561em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.315em; border-left: 0px solid; width: 0px; height: 1.205em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mi>x</mi><mi>y</mi></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-10">f(x, y)=xy</script>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;;&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-144" style="width: 7.994em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.557em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.053em, 1006.56em, 3.607em, -1000em); top: -2.561em; left: 0em;"><span class="mrow" id="MathJax-Span-145"><span class="mfrac" id="MathJax-Span-146"><span style="display: inline-block; position: relative; width: 1.038em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.164em, 1000.9em, 4.357em, -1000em); top: -4.672em; left: 50%; margin-left: -0.448em;"><span class="mrow" id="MathJax-Span-147"><span class="mi" id="MathJax-Span-148" style="font-family: STIXGeneral;">∂</span><span class="mi" id="MathJax-Span-149" style="font-family: STIXGeneral; font-style: italic; text-rendering: optimizelegibility;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; clip: rect(3.174em, 1000.92em, 4.161em, -1000em); top: -3.31em; left: 50%; margin-left: -0.459em;"><span class="mrow" id="MathJax-Span-150"><span class="mi" id="MathJax-Span-151" style="font-family: STIXGeneral;">∂</span><span class="mi" id="MathJax-Span-152" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; clip: rect(0.858em, 1001.04em, 1.23em, -1000em); top: -1.296em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.038em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.076em;"></span></span></span></span><span class="mo" id="MathJax-Span-153" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-154" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.313em;">y</span><span class="mo" id="MathJax-Span-155" style="font-family: STIXGeneral;">;</span><span class="mfrac" id="MathJax-Span-156" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.035em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.164em, 1000.9em, 4.357em, -1000em); top: -4.672em; left: 50%; margin-left: -0.448em;"><span class="mrow" id="MathJax-Span-157"><span class="mi" id="MathJax-Span-158" style="font-family: STIXGeneral;">∂</span><span class="mi" id="MathJax-Span-159" style="font-family: STIXGeneral; font-style: italic; text-rendering: optimizelegibility;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; clip: rect(3.174em, 1000.9em, 4.356em, -1000em); top: -3.31em; left: 50%; margin-left: -0.458em;"><span class="mrow" id="MathJax-Span-160"><span class="mi" id="MathJax-Span-161" style="font-family: STIXGeneral;">∂</span><span class="mi" id="MathJax-Span-162" style="font-family: STIXGeneral; font-style: italic;">y</span></span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; clip: rect(0.858em, 1001.04em, 1.23em, -1000em); top: -1.296em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.035em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.076em;"></span></span></span></span><span class="mo" id="MathJax-Span-163" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-164" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.313em;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.561em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.151em; border-left: 0px solid; width: 0px; height: 2.866em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>f</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow></mfrac><mo>=</mo><mi>y</mi><mo>;</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>f</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>y</mi></mrow></mfrac><mo>=</mo><mi>x</mi></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-11">\frac{\partial f}{\partial x}=y; \frac{\partial f}{\partial y}=x</script>

<p><strong>Tanh</strong>:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;msup&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;msup&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-165" style="width: 7.994em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.557em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(0.982em, 1006.56em, 3.442em, -1000em); top: -2.561em; left: 0em;"><span class="mrow" id="MathJax-Span-166"><span class="mi" id="MathJax-Span-167" style="font-family: STIXGeneral; font-style: italic; text-rendering: optimizelegibility;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span class="mo" id="MathJax-Span-168" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-169" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-170" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-171" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="mfrac" id="MathJax-Span-172" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 3.46em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.093em, 1003.34em, 4.291em, -1000em); top: -4.672em; left: 50%; margin-left: -1.67em;"><span class="mrow" id="MathJax-Span-173"><span class="msubsup" id="MathJax-Span-174"><span style="display: inline-block; position: relative; width: 0.835em; height: 0px;"><span style="position: absolute; clip: rect(3.401em, 1000.41em, 4.161em, -1000em); top: -3.996em; left: 0em;"><span class="mi" id="MathJax-Span-175" style="font-family: STIXGeneral; font-style: italic;">e</span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; top: -4.359em; left: 0.444em;"><span class="mi" id="MathJax-Span-176" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span></span></span><span class="mo" id="MathJax-Span-177" style="font-family: STIXGeneral; padding-left: 0.25em;">−</span><span class="msubsup" id="MathJax-Span-178" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.319em; height: 0px;"><span style="position: absolute; clip: rect(3.401em, 1000.41em, 4.161em, -1000em); top: -3.996em; left: 0em;"><span class="mi" id="MathJax-Span-179" style="font-family: STIXGeneral; font-style: italic;">e</span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; top: -4.359em; left: 0.444em;"><span class="texatom" id="MathJax-Span-180"><span class="mrow" id="MathJax-Span-181"><span class="mo" id="MathJax-Span-182" style="font-size: 70.7%; font-family: STIXGeneral;">−</span><span class="mi" id="MathJax-Span-183" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; clip: rect(3.167em, 1003.34em, 4.191em, -1000em); top: -3.31em; left: 50%; margin-left: -1.67em;"><span class="mrow" id="MathJax-Span-184"><span class="msubsup" id="MathJax-Span-185"><span style="display: inline-block; position: relative; width: 0.835em; height: 0px;"><span style="position: absolute; clip: rect(3.401em, 1000.41em, 4.161em, -1000em); top: -3.996em; left: 0em;"><span class="mi" id="MathJax-Span-186" style="font-family: STIXGeneral; font-style: italic;">e</span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; top: -4.285em; left: 0.444em;"><span class="mi" id="MathJax-Span-187" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span></span></span><span class="mo" id="MathJax-Span-188" style="font-family: STIXGeneral; padding-left: 0.25em;">+</span><span class="msubsup" id="MathJax-Span-189" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.319em; height: 0px;"><span style="position: absolute; clip: rect(3.401em, 1000.41em, 4.161em, -1000em); top: -3.996em; left: 0em;"><span class="mi" id="MathJax-Span-190" style="font-family: STIXGeneral; font-style: italic;">e</span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; top: -4.285em; left: 0.444em;"><span class="texatom" id="MathJax-Span-191"><span class="mrow" id="MathJax-Span-192"><span class="mo" id="MathJax-Span-193" style="font-size: 70.7%; font-family: STIXGeneral;">−</span><span class="mi" id="MathJax-Span-194" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; clip: rect(0.858em, 1003.46em, 1.23em, -1000em); top: -1.296em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.46em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.076em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.561em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.949em; border-left: 0px solid; width: 0px; height: 2.752em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><msup><mi>e</mi><mi>x</mi></msup><mo>−</mo><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mi>x</mi></mrow></msup></mrow><mrow><msup><mi>e</mi><mi>x</mi></msup><mo>+</mo><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mi>x</mi></mrow></msup></mrow></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-12">f(x)=\frac{e^x-e^{-x}}{e^x+e^{-x}}</script>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;tanh&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-195" style="width: 9.275em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.582em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.048em, 1007.58em, 3.414em, -1000em); top: -2.561em; left: 0em;"><span class="mrow" id="MathJax-Span-196"><span class="mfrac" id="MathJax-Span-197"><span style="display: inline-block; position: relative; width: 1.094em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.159em, 1000.95em, 4.357em, -1000em); top: -4.672em; left: 50%; margin-left: -0.476em;"><span class="mrow" id="MathJax-Span-198"><span class="mi" id="MathJax-Span-199" style="font-family: STIXGeneral; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.027em;"></span></span><span class="mi" id="MathJax-Span-200" style="font-family: STIXGeneral; font-style: italic; text-rendering: optimizelegibility;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; clip: rect(3.159em, 1000.97em, 4.163em, -1000em); top: -3.31em; left: 50%; margin-left: -0.487em;"><span class="mrow" id="MathJax-Span-201"><span class="mi" id="MathJax-Span-202" style="font-family: STIXGeneral; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.027em;"></span></span><span class="mi" id="MathJax-Span-203" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; clip: rect(0.858em, 1001.09em, 1.23em, -1000em); top: -1.296em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.094em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.076em;"></span></span></span></span><span class="mo" id="MathJax-Span-204" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="mn" id="MathJax-Span-205" style="font-family: STIXGeneral; padding-left: 0.313em;">1</span><span class="mo" id="MathJax-Span-206" style="font-family: STIXGeneral; padding-left: 0.25em;">−</span><span class="mi" id="MathJax-Span-207" style="font-family: STIXGeneral; padding-left: 0.25em;">tanh</span><span class="mo" id="MathJax-Span-208"></span><span class="mo" id="MathJax-Span-209" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-210" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-211"><span style="display: inline-block; position: relative; width: 0.762em; height: 0px;"><span style="position: absolute; clip: rect(3.166em, 1000.29em, 4.327em, -1000em); top: -3.996em; left: 0em;"><span class="mo" id="MathJax-Span-212" style="font-family: STIXGeneral;">)</span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.333em;"><span class="mn" id="MathJax-Span-213" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.561em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.915em; border-left: 0px solid; width: 0px; height: 2.636em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mfrac><mrow><mi>d</mi><mi>f</mi></mrow><mrow><mi>d</mi><mi>x</mi></mrow></mfrac><mo>=</mo><mn>1</mn><mo>−</mo><mi>tanh</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>x</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-13">\frac{d f}{d x}=1-\tanh(x)^2</script>

<p><strong>Pow</strong>:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-214" style="width: 5.638em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.611em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.683em, 1004.61em, 2.922em, -1000em); top: -2.561em; left: 0em;"><span class="mrow" id="MathJax-Span-215"><span class="mi" id="MathJax-Span-216" style="font-family: STIXGeneral; font-style: italic; text-rendering: optimizelegibility;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span class="mo" id="MathJax-Span-217" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-218" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-219" style="font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-220" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.188em;">y</span><span class="mo" id="MathJax-Span-221" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-222" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-223" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 0.887em; height: 0px;"><span style="position: absolute; clip: rect(3.401em, 1000.45em, 4.161em, -1000em); top: -3.996em; left: 0em;"><span class="mi" id="MathJax-Span-224" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.498em;"><span class="mi" id="MathJax-Span-225" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.561em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.315em; border-left: 0px solid; width: 0px; height: 1.262em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mi>x</mi><mi>y</mi></msup></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-14">f(x, y)=x^y</script>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-226" style="width: 7.636em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.25em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.053em, 1006.25em, 3.412em, -1000em); top: -2.561em; left: 0em;"><span class="mrow" id="MathJax-Span-227"><span class="mfrac" id="MathJax-Span-228"><span style="display: inline-block; position: relative; width: 1.038em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.164em, 1000.9em, 4.357em, -1000em); top: -4.672em; left: 50%; margin-left: -0.448em;"><span class="mrow" id="MathJax-Span-229"><span class="mi" id="MathJax-Span-230" style="font-family: STIXGeneral;">∂</span><span class="mi" id="MathJax-Span-231" style="font-family: STIXGeneral; font-style: italic; text-rendering: optimizelegibility;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; clip: rect(3.174em, 1000.92em, 4.161em, -1000em); top: -3.31em; left: 50%; margin-left: -0.459em;"><span class="mrow" id="MathJax-Span-232"><span class="mi" id="MathJax-Span-233" style="font-family: STIXGeneral;">∂</span><span class="mi" id="MathJax-Span-234" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; clip: rect(0.858em, 1001.04em, 1.23em, -1000em); top: -1.296em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.038em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.076em;"></span></span></span></span><span class="mo" id="MathJax-Span-235" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-236" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.313em;">y</span><span class="mo" id="MathJax-Span-237" style="font-family: STIXGeneral; padding-left: 0.25em;">∗</span><span class="msubsup" id="MathJax-Span-238" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 2.196em; height: 0px;"><span style="position: absolute; clip: rect(3.401em, 1000.45em, 4.161em, -1000em); top: -3.996em; left: 0em;"><span class="mi" id="MathJax-Span-239" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.498em;"><span class="texatom" id="MathJax-Span-240"><span class="mrow" id="MathJax-Span-241"><span class="mo" id="MathJax-Span-242" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-243" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">y</span><span class="mo" id="MathJax-Span-244" style="font-size: 70.7%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-245" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-246" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.561em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.913em; border-left: 0px solid; width: 0px; height: 2.628em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>f</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow></mfrac><mo>=</mo><mi>y</mi><mo>∗</mo><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>y</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-15">\frac{\partial f}{\partial x}=y * x^{(y-1)}</script>

<p>(leaving out the derivative <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-247" style="width: 1.283em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.025em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.069em, 1001.03em, 2.932em, -1000em); top: -2.254em; left: 0em;"><span class="mrow" id="MathJax-Span-248"><span class="mfrac" id="MathJax-Span-249"><span style="display: inline-block; position: relative; width: 0.767em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.363em, 1000.63em, 4.296em, -1000em); top: -4.548em; left: 50%; margin-left: -0.316em;"><span class="mrow" id="MathJax-Span-250"><span class="mi" id="MathJax-Span-251" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="mi" id="MathJax-Span-252" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic; text-rendering: optimizelegibility;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.103em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; clip: rect(3.37em, 1000.63em, 4.295em, -1000em); top: -3.617em; left: 50%; margin-left: -0.324em;"><span class="mrow" id="MathJax-Span-253"><span class="mi" id="MathJax-Span-254" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="mi" id="MathJax-Span-255" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">y</span></span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; clip: rect(0.858em, 1000.77em, 1.23em, -1000em); top: -1.296em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.767em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.076em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.254em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.702em; border-left: 0px solid; width: 0px; height: 2.023em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>f</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>y</mi></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-16">\frac{\partial f}{\partial y}</script> for the power function, because I’m being lazy and it’s not important for our purposes)</p>

<h3 id="chain-rule">Chain rule</h3>

<p>The amount of times that I’ve heard backpropagation described as a 
“recursive application of the chain rule” without the explainer 
providing intuition about what that actually <em>means</em> makes my 
head spin. In the Andrej’s video where he covers backpropagation, he 
references Wikipedia’s explanation of the chain rule, which I think is 
one of the most cogent explanations of a topic that is frequently 
over-complicated in the context of backpropagation. Specifically, 
Wikipedia says:</p>

<blockquote>
  <p>If a variable z depends on the variable y, which itself depends on 
the variable x (…), then z depends on x as well, via the intermediate 
variable y. In this case, the chain rule is expressed as <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-256" style="width: 5.467em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.463em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.389em, 1004.46em, 3.211em, -1000em); top: -2.55em; left: 0em;"><span class="mrow" id="MathJax-Span-257"><span class="mfrac" id="MathJax-Span-258"><span style="display: inline-block; position: relative; width: 0.809em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.388em, 1000.64em, 4.201em, -1000em); top: -4.46em; left: 50%; margin-left: -0.324em;"><span class="mrow" id="MathJax-Span-259"><span class="mi" id="MathJax-Span-260" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.019em;"></span></span><span class="mi" id="MathJax-Span-261" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">z</span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.388em, 1000.69em, 4.153em, -1000em); top: -3.629em; left: 50%; margin-left: -0.344em;"><span class="mrow" id="MathJax-Span-262"><span class="mi" id="MathJax-Span-263" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.019em;"></span></span><span class="mi" id="MathJax-Span-264" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(0.851em, 1000.81em, 1.184em, -1000em); top: -1.267em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.809em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.047em;"></span></span></span></span><span class="mo" id="MathJax-Span-265" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="mfrac" id="MathJax-Span-266" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.388em, 1000.64em, 4.201em, -1000em); top: -4.46em; left: 50%; margin-left: -0.324em;"><span class="mrow" id="MathJax-Span-267"><span class="mi" id="MathJax-Span-268" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.019em;"></span></span><span class="mi" id="MathJax-Span-269" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">z</span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.388em, 1000.67em, 4.29em, -1000em); top: -3.629em; left: 50%; margin-left: -0.343em;"><span class="mrow" id="MathJax-Span-270"><span class="mi" id="MathJax-Span-271" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.019em;"></span></span><span class="mi" id="MathJax-Span-272" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">y</span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(0.851em, 1000.81em, 1.184em, -1000em); top: -1.267em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.807em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.047em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-273"><span style="display: inline-block; position: relative; width: 0.809em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.388em, 1000.67em, 4.29em, -1000em); top: -4.548em; left: 50%; margin-left: -0.343em;"><span class="mrow" id="MathJax-Span-274"><span class="mi" id="MathJax-Span-275" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.019em;"></span></span><span class="mi" id="MathJax-Span-276" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">y</span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.388em, 1000.69em, 4.153em, -1000em); top: -3.629em; left: 50%; margin-left: -0.344em;"><span class="mrow" id="MathJax-Span-277"><span class="mi" id="MathJax-Span-278" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.019em;"></span></span><span class="mi" id="MathJax-Span-279" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(0.851em, 1000.81em, 1.184em, -1000em); top: -1.267em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.809em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.047em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.55em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.695em; border-left: 0px solid; width: 0px; height: 2em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi>d</mi><mi>z</mi></mrow><mrow><mi>d</mi><mi>x</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi>d</mi><mi>z</mi></mrow><mrow><mi>d</mi><mi>y</mi></mrow></mfrac><mfrac><mrow><mi>d</mi><mi>y</mi></mrow><mrow><mi>d</mi><mi>x</mi></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-17">\frac{d z}{d x}=\frac{d z}{d y}\frac{d y}{d x}</script></p>
</blockquote>

<p>Effectively, we are able to simply multiply the rates of change if we have <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-280" style="width: 1.283em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.025em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.154em, 1001.03em, 2.942em, -1000em); top: -2.254em; left: 0em;"><span class="mrow" id="MathJax-Span-281"><span class="mfrac" id="MathJax-Span-282"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.359em, 1000.64em, 4.207em, -1000em); top: -4.459em; left: 50%; margin-left: -0.324em;"><span class="mrow" id="MathJax-Span-283"><span class="mi" id="MathJax-Span-284" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.019em;"></span></span><span class="mi" id="MathJax-Span-285" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">z</span></span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; clip: rect(3.359em, 1000.67em, 4.295em, -1000em); top: -3.607em; left: 50%; margin-left: -0.343em;"><span class="mrow" id="MathJax-Span-286"><span class="mi" id="MathJax-Span-287" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.019em;"></span></span><span class="mi" id="MathJax-Span-288" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">y</span></span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; clip: rect(0.858em, 1000.81em, 1.23em, -1000em); top: -1.296em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.807em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.076em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.254em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.715em; border-left: 0px solid; width: 0px; height: 1.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi>d</mi><mi>z</mi></mrow><mrow><mi>d</mi><mi>y</mi></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-18">\frac{d z}{d y}</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-289" style="width: 1.335em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.076em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.066em, 1001.08em, 2.806em, -1000em); top: -2.254em; left: 0em;"><span class="mrow" id="MathJax-Span-290"><span class="mfrac" id="MathJax-Span-291"><span style="display: inline-block; position: relative; width: 0.809em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.359em, 1000.67em, 4.295em, -1000em); top: -4.548em; left: 50%; margin-left: -0.343em;"><span class="mrow" id="MathJax-Span-292"><span class="mi" id="MathJax-Span-293" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.019em;"></span></span><span class="mi" id="MathJax-Span-294" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">y</span></span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; clip: rect(3.359em, 1000.69em, 4.159em, -1000em); top: -3.607em; left: 50%; margin-left: -0.344em;"><span class="mrow" id="MathJax-Span-295"><span class="mi" id="MathJax-Span-296" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.019em;"></span></span><span class="mi" id="MathJax-Span-297" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; clip: rect(0.858em, 1000.81em, 1.23em, -1000em); top: -1.296em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.809em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.076em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.254em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.548em; border-left: 0px solid; width: 0px; height: 1.873em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi>d</mi><mi>y</mi></mrow><mrow><mi>d</mi><mi>x</mi></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-19">\frac{d y}{d x}</script> to get <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-20-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-298" style="width: 1.335em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.076em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.154em, 1001.08em, 2.806em, -1000em); top: -2.254em; left: 0em;"><span class="mrow" id="MathJax-Span-299"><span class="mfrac" id="MathJax-Span-300"><span style="display: inline-block; position: relative; width: 0.809em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.359em, 1000.64em, 4.207em, -1000em); top: -4.459em; left: 50%; margin-left: -0.324em;"><span class="mrow" id="MathJax-Span-301"><span class="mi" id="MathJax-Span-302" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.019em;"></span></span><span class="mi" id="MathJax-Span-303" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">z</span></span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; clip: rect(3.359em, 1000.69em, 4.159em, -1000em); top: -3.607em; left: 50%; margin-left: -0.344em;"><span class="mrow" id="MathJax-Span-304"><span class="mi" id="MathJax-Span-305" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.019em;"></span></span><span class="mi" id="MathJax-Span-306" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; clip: rect(0.858em, 1000.81em, 1.23em, -1000em); top: -1.296em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.809em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.076em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.254em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.548em; border-left: 0px solid; width: 0px; height: 1.765em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi>d</mi><mi>z</mi></mrow><mrow><mi>d</mi><mi>x</mi></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-20">\frac{d z}{d x}</script>. Although <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-307" style="width: 1.283em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.025em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.154em, 1001.03em, 2.942em, -1000em); top: -2.254em; left: 0em;"><span class="mrow" id="MathJax-Span-308"><span class="mfrac" id="MathJax-Span-309"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.359em, 1000.64em, 4.207em, -1000em); top: -4.459em; left: 50%; margin-left: -0.324em;"><span class="mrow" id="MathJax-Span-310"><span class="mi" id="MathJax-Span-311" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.019em;"></span></span><span class="mi" id="MathJax-Span-312" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">z</span></span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; clip: rect(3.359em, 1000.67em, 4.295em, -1000em); top: -3.607em; left: 50%; margin-left: -0.343em;"><span class="mrow" id="MathJax-Span-313"><span class="mi" id="MathJax-Span-314" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.019em;"></span></span><span class="mi" id="MathJax-Span-315" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">y</span></span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; clip: rect(0.858em, 1000.81em, 1.23em, -1000em); top: -1.296em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.807em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.076em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.254em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.715em; border-left: 0px solid; width: 0px; height: 1.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi>d</mi><mi>z</mi></mrow><mrow><mi>d</mi><mi>y</mi></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-21">\frac{d z}{d y}</script> isn’t really a fraction, the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-316" style="width: 1.181em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.973em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.725em, 1000.96em, 2.921em, -1000em); top: -2.561em; left: 0em;"><span class="mrow" id="MathJax-Span-317"><span class="mi" id="MathJax-Span-318" style="font-family: STIXGeneral; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.027em;"></span></span><span class="mi" id="MathJax-Span-319" style="font-family: STIXGeneral; font-style: italic;">y</span></span><span style="display: inline-block; width: 0px; height: 2.561em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.314em; border-left: 0px solid; width: 0px; height: 1.21em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-22">d y</script> terms “cancel each other out” in the same way in this context.</p>

<p>The Wikipedia page offers a concrete example, as well. Specifically, 
it asks us to consider the speed of a human, a bicycle, and a car. Lets 
say <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-23-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-320" style="width: 0.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.512em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.725em, 1000.49em, 2.724em, -1000em); top: -2.561em; left: 0em;"><span class="mrow" id="MathJax-Span-321"><span class="mi" id="MathJax-Span-322" style="font-family: STIXGeneral; font-style: italic;">h</span></span><span style="display: inline-block; width: 0px; height: 2.561em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 0.969em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>h</mi></math></span></span><script type="math/tex" id="MathJax-Element-23">h</script> represents the speed of a human, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-24-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-323" style="width: 3.435em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.818em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.725em, 1002.8em, 2.726em, -1000em); top: -2.561em; left: 0em;"><span class="mrow" id="MathJax-Span-324"><span class="mi" id="MathJax-Span-325" style="font-family: STIXGeneral; font-style: italic;">b</span><span class="mo" id="MathJax-Span-326" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="mn" id="MathJax-Span-327" style="font-family: STIXGeneral; padding-left: 0.313em;">2</span><span class="mi" id="MathJax-Span-328" style="font-family: STIXGeneral; font-style: italic;">h</span></span><span style="display: inline-block; width: 0px; height: 2.561em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 0.972em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi><mo>=</mo><mn>2</mn><mi>h</mi></math></span></span><script type="math/tex" id="MathJax-Element-24">b=2h</script> the speed of the bicycle, and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-25-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-329" style="width: 3.384em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.766em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.725em, 1002.74em, 2.726em, -1000em); top: -2.561em; left: 0em;"><span class="mrow" id="MathJax-Span-330"><span class="mi" id="MathJax-Span-331" style="font-family: STIXGeneral; font-style: italic;">c</span><span class="mo" id="MathJax-Span-332" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="mn" id="MathJax-Span-333" style="font-family: STIXGeneral; padding-left: 0.313em;">4</span><span class="mi" id="MathJax-Span-334" style="font-family: STIXGeneral; font-style: italic;">b</span></span><span style="display: inline-block; width: 0px; height: 2.561em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 0.972em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi><mo>=</mo><mn>4</mn><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-25">c=4b</script> the speed of the car. We want to find the rate of change of the car with respect to the human. We can calculate <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-26-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-335" style="width: 3.589em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.92em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.51em, 1002.89em, 3.113em, -1000em); top: -2.561em; left: 0em;"><span class="mrow" id="MathJax-Span-336"><span class="mfrac" id="MathJax-Span-337"><span style="display: inline-block; position: relative; width: 0.846em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.359em, 1000.67em, 4.159em, -1000em); top: -4.411em; left: 50%; margin-left: -0.343em;"><span class="mrow" id="MathJax-Span-338"><span class="mi" id="MathJax-Span-339" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.019em;"></span></span><span class="mi" id="MathJax-Span-340" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">c</span></span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; clip: rect(3.359em, 1000.71em, 4.159em, -1000em); top: -3.607em; left: 50%; margin-left: -0.363em;"><span class="mrow" id="MathJax-Span-341"><span class="mi" id="MathJax-Span-342" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.019em;"></span></span><span class="mi" id="MathJax-Span-343" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">b</span></span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; clip: rect(0.858em, 1000.85em, 1.23em, -1000em); top: -1.296em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.846em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.076em;"></span></span></span></span><span class="mo" id="MathJax-Span-344" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="mn" id="MathJax-Span-345" style="font-family: STIXGeneral; padding-left: 0.313em;">4</span></span><span style="display: inline-block; width: 0px; height: 2.561em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.548em; border-left: 0px solid; width: 0px; height: 1.707em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi>d</mi><mi>c</mi></mrow><mrow><mi>d</mi><mi>b</mi></mrow></mfrac><mo>=</mo><mn>4</mn></math></span></span><script type="math/tex" id="MathJax-Element-26">\frac{d c}{d b} = 4</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-27-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-346" style="width: 3.589em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.92em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.51em, 1002.89em, 3.113em, -1000em); top: -2.561em; left: 0em;"><span class="mrow" id="MathJax-Span-347"><span class="mfrac" id="MathJax-Span-348"><span style="display: inline-block; position: relative; width: 0.846em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.359em, 1000.71em, 4.159em, -1000em); top: -4.411em; left: 50%; margin-left: -0.363em;"><span class="mrow" id="MathJax-Span-349"><span class="mi" id="MathJax-Span-350" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.019em;"></span></span><span class="mi" id="MathJax-Span-351" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">b</span></span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; clip: rect(3.359em, 1000.71em, 4.159em, -1000em); top: -3.607em; left: 50%; margin-left: -0.363em;"><span class="mrow" id="MathJax-Span-352"><span class="mi" id="MathJax-Span-353" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.019em;"></span></span><span class="mi" id="MathJax-Span-354" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">h</span></span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; clip: rect(0.858em, 1000.85em, 1.23em, -1000em); top: -1.296em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.846em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.076em;"></span></span></span></span><span class="mo" id="MathJax-Span-355" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="mn" id="MathJax-Span-356" style="font-family: STIXGeneral; padding-left: 0.313em;">2</span></span><span style="display: inline-block; width: 0px; height: 2.561em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.548em; border-left: 0px solid; width: 0px; height: 1.707em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi>d</mi><mi>b</mi></mrow><mrow><mi>d</mi><mi>h</mi></mrow></mfrac><mo>=</mo><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-27">\frac{d b}{d h} = 2</script> and by the chain rule, we know that <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-28-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;8&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-357" style="width: 11.888em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.734em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.51em, 1009.68em, 3.113em, -1000em); top: -2.561em; left: 0em;"><span class="mrow" id="MathJax-Span-358"><span class="mfrac" id="MathJax-Span-359"><span style="display: inline-block; position: relative; width: 0.846em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.359em, 1000.67em, 4.159em, -1000em); top: -4.411em; left: 50%; margin-left: -0.343em;"><span class="mrow" id="MathJax-Span-360"><span class="mi" id="MathJax-Span-361" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.019em;"></span></span><span class="mi" id="MathJax-Span-362" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">c</span></span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; clip: rect(3.359em, 1000.71em, 4.159em, -1000em); top: -3.607em; left: 50%; margin-left: -0.363em;"><span class="mrow" id="MathJax-Span-363"><span class="mi" id="MathJax-Span-364" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.019em;"></span></span><span class="mi" id="MathJax-Span-365" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">h</span></span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; clip: rect(0.858em, 1000.85em, 1.23em, -1000em); top: -1.296em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.846em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.076em;"></span></span></span></span><span class="mo" id="MathJax-Span-366" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="mfrac" id="MathJax-Span-367" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 0.846em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.359em, 1000.67em, 4.159em, -1000em); top: -4.411em; left: 50%; margin-left: -0.343em;"><span class="mrow" id="MathJax-Span-368"><span class="mi" id="MathJax-Span-369" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.019em;"></span></span><span class="mi" id="MathJax-Span-370" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">c</span></span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; clip: rect(3.359em, 1000.71em, 4.159em, -1000em); top: -3.607em; left: 50%; margin-left: -0.363em;"><span class="mrow" id="MathJax-Span-371"><span class="mi" id="MathJax-Span-372" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.019em;"></span></span><span class="mi" id="MathJax-Span-373" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">b</span></span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; clip: rect(0.858em, 1000.85em, 1.23em, -1000em); top: -1.296em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.846em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.076em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-374"><span style="display: inline-block; position: relative; width: 0.846em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.359em, 1000.71em, 4.159em, -1000em); top: -4.411em; left: 50%; margin-left: -0.363em;"><span class="mrow" id="MathJax-Span-375"><span class="mi" id="MathJax-Span-376" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.019em;"></span></span><span class="mi" id="MathJax-Span-377" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">b</span></span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; clip: rect(3.359em, 1000.71em, 4.159em, -1000em); top: -3.607em; left: 50%; margin-left: -0.363em;"><span class="mrow" id="MathJax-Span-378"><span class="mi" id="MathJax-Span-379" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.019em;"></span></span><span class="mi" id="MathJax-Span-380" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">h</span></span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; clip: rect(0.858em, 1000.85em, 1.23em, -1000em); top: -1.296em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.846em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.076em;"></span></span></span></span><span class="mo" id="MathJax-Span-381" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="mn" id="MathJax-Span-382" style="font-family: STIXGeneral; padding-left: 0.313em;">4</span><span class="mo" id="MathJax-Span-383" style="font-family: STIXGeneral; padding-left: 0.25em;">∗</span><span class="mn" id="MathJax-Span-384" style="font-family: STIXGeneral; padding-left: 0.25em;">2</span><span class="mo" id="MathJax-Span-385" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="mn" id="MathJax-Span-386" style="font-family: STIXGeneral; padding-left: 0.313em;">8</span></span><span style="display: inline-block; width: 0px; height: 2.561em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.548em; border-left: 0px solid; width: 0px; height: 1.707em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi>d</mi><mi>c</mi></mrow><mrow><mi>d</mi><mi>h</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi>d</mi><mi>c</mi></mrow><mrow><mi>d</mi><mi>b</mi></mrow></mfrac><mfrac><mrow><mi>d</mi><mi>b</mi></mrow><mrow><mi>d</mi><mi>h</mi></mrow></mfrac><mo>=</mo><mn>4</mn><mo>∗</mo><mn>2</mn><mo>=</mo><mn>8</mn></math></span></span><script type="math/tex" id="MathJax-Element-28">\frac{d c}{d h} = \frac{d c}{d b} \frac{d b}{d h} = 4 * 2 = 8</script>, or that a car is 8 times as fast as a human.</p>

<p>In the context of backpropagation, for an arbitrary weight, we have a gradient that flows into <em>the current weight</em>
 from somewhere further down the graph. This value represents how all of
 the downstream activations that the current weight feeds into affect 
the loss. Since the performance of the network is affected by all the 
activations downstream that the current weight affects, we need to look <em>how it indirectly affects the loss through the nodes that it contributes to downstream</em>. The chain rule gives us a way to compute this value. We must <em>multiply</em>
 the “global” derivative that has been propagated backwards with the 
“local” derivative of the current weight. Once we do this, the current 
node’s derivative becomes the new “global” derivative and we continue to
 pass the new “global” derivative backwards. This is what is meant by 
“recursively applying the chain rule”. You don’t have to understand all 
of this now, and it should become clear with a spelled out example in 
the next section.</p>

<p><br></p>

<hr>

<p><br></p>

<h2 id="gradients-on-a-computational-graph">Gradients on a Computational Graph</h2>

<p>Now that we’ve covered the relevant bits of calculus and computational graphs, we are going to combine them to take derivatives <em>on</em>
 a computational graph using the chain rule. We will first go over a 
graph that is one node deep and then we will make it deeper so that we 
are forced to use the chain rule to propagate gradients using the chain 
rule.</p>

<h3 id="the-trivial-case">The Trivial Case</h3>

<p>Let’s look at the simplest form of a computational graph that we made above. We want to compute the derivative of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-29-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-387" style="width: 0.566em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.461em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.967em, 1000.44em, 2.726em, -1000em); top: -2.561em; left: 0em;"><span class="mrow" id="MathJax-Span-388"><span class="mi" id="MathJax-Span-389" style="font-family: STIXGeneral; font-style: italic;">c</span></span><span style="display: inline-block; width: 0px; height: 2.561em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 0.676em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi></math></span></span><script type="math/tex" id="MathJax-Element-29">c</script> with respect to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-30-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-390" style="width: 0.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.512em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.967em, 1000.49em, 2.726em, -1000em); top: -2.561em; left: 0em;"><span class="mrow" id="MathJax-Span-391"><span class="mi" id="MathJax-Span-392" style="font-family: STIXGeneral; font-style: italic;">a</span></span><span style="display: inline-block; width: 0px; height: 2.561em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 0.676em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-30">a</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-31-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-393" style="width: 0.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.512em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.725em, 1000.49em, 2.726em, -1000em); top: -2.561em; left: 0em;"><span class="mrow" id="MathJax-Span-394"><span class="mi" id="MathJax-Span-395" style="font-family: STIXGeneral; font-style: italic;">b</span></span><span style="display: inline-block; width: 0px; height: 2.561em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 0.972em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-31">b</script>. We know trivially that as <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-32-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-396" style="width: 0.566em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.461em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.967em, 1000.44em, 2.726em, -1000em); top: -2.561em; left: 0em;"><span class="mrow" id="MathJax-Span-397"><span class="mi" id="MathJax-Span-398" style="font-family: STIXGeneral; font-style: italic;">c</span></span><span style="display: inline-block; width: 0px; height: 2.561em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 0.676em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi></math></span></span><script type="math/tex" id="MathJax-Element-32">c</script> varies, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-33-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-399" style="width: 0.566em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.461em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.967em, 1000.44em, 2.726em, -1000em); top: -2.561em; left: 0em;"><span class="mrow" id="MathJax-Span-400"><span class="mi" id="MathJax-Span-401" style="font-family: STIXGeneral; font-style: italic;">c</span></span><span style="display: inline-block; width: 0px; height: 2.561em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 0.676em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi></math></span></span><script type="math/tex" id="MathJax-Element-33">c</script> varies proportionally to it. The derivative of any function with respect to itself is 1:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-34-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-402" style="width: 3.845em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.125em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.048em, 1003.02em, 3.414em, -1000em); top: -2.561em; left: 0em;"><span class="mrow" id="MathJax-Span-403"><span class="mfrac" id="MathJax-Span-404"><span style="display: inline-block; position: relative; width: 1.091em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.159em, 1000.95em, 4.163em, -1000em); top: -4.672em; left: 50%; margin-left: -0.486em;"><span class="mrow" id="MathJax-Span-405"><span class="mi" id="MathJax-Span-406" style="font-family: STIXGeneral; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.027em;"></span></span><span class="mi" id="MathJax-Span-407" style="font-family: STIXGeneral; font-style: italic;">c</span></span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; clip: rect(3.159em, 1000.95em, 4.163em, -1000em); top: -3.31em; left: 50%; margin-left: -0.486em;"><span class="mrow" id="MathJax-Span-408"><span class="mi" id="MathJax-Span-409" style="font-family: STIXGeneral; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.027em;"></span></span><span class="mi" id="MathJax-Span-410" style="font-family: STIXGeneral; font-style: italic;">c</span></span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; clip: rect(0.858em, 1001.09em, 1.23em, -1000em); top: -1.296em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.091em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.076em;"></span></span></span></span><span class="mo" id="MathJax-Span-411" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="mn" id="MathJax-Span-412" style="font-family: STIXGeneral; padding-left: 0.313em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.561em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.915em; border-left: 0px solid; width: 0px; height: 2.636em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mfrac><mrow><mi>d</mi><mi>c</mi></mrow><mrow><mi>d</mi><mi>c</mi></mrow></mfrac><mo>=</mo><mn>1</mn></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-34">\frac{dc}{dc} = 1</script>

<p>We can fill this out in our computational graph</p>

<center>
<p>
    <img src="Backpropagation%20-%20re-writing%20Micrograd%20Will%20Beckman%20blog_files/computational_graph_grad_1_1.png" alt="">
</p>
</center>

<p>We know that <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-35-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-413" style="width: 6.919em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.635em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.725em, 1005.61em, 2.892em, -1000em); top: -2.561em; left: 0em;"><span class="mrow" id="MathJax-Span-414"><span class="mi" id="MathJax-Span-415" style="font-family: STIXGeneral; font-style: italic;">c</span><span class="mo" id="MathJax-Span-416" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-417" style="font-family: STIXGeneral; font-style: italic;">a</span><span class="mo" id="MathJax-Span-418" style="font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-419" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.188em;">b</span><span class="mo" id="MathJax-Span-420" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-421" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-422" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.313em;">a</span><span class="mo" id="MathJax-Span-423" style="font-family: STIXGeneral; padding-left: 0.25em;">⋅</span><span class="mi" id="MathJax-Span-424" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.25em;">b</span></span><span style="display: inline-block; width: 0px; height: 2.561em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.278em; border-left: 0px solid; width: 0px; height: 1.174em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi><mo stretchy="false">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="false">)</mo><mo>=</mo><mi>a</mi><mo>⋅</mo><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-35">c(a, b) = a \cdot b</script> and, further that <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-36-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-425" style="width: 3.537em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.869em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.522em, 1002.84em, 3.101em, -1000em); top: -2.561em; left: 0em;"><span class="mrow" id="MathJax-Span-426"><span class="mfrac" id="MathJax-Span-427"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.37em, 1000.63em, 4.157em, -1000em); top: -4.41em; left: 50%; margin-left: -0.324em;"><span class="mrow" id="MathJax-Span-428"><span class="mi" id="MathJax-Span-429" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="mi" id="MathJax-Span-430" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">c</span></span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; clip: rect(3.37em, 1000.67em, 4.157em, -1000em); top: -3.617em; left: 50%; margin-left: -0.344em;"><span class="mrow" id="MathJax-Span-431"><span class="mi" id="MathJax-Span-432" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="mi" id="MathJax-Span-433" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">a</span></span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; clip: rect(0.858em, 1000.81em, 1.23em, -1000em); top: -1.296em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.807em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.076em;"></span></span></span></span><span class="mo" id="MathJax-Span-434" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-435" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.313em;">b</span></span><span style="display: inline-block; width: 0px; height: 2.561em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.534em; border-left: 0px solid; width: 0px; height: 1.677em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>c</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>a</mi></mrow></mfrac><mo>=</mo><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-36">\frac{\partial c}{\partial a} = b</script>. By the same logic, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-37-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-436" style="width: 3.537em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.869em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.522em, 1002.84em, 3.112em, -1000em); top: -2.561em; left: 0em;"><span class="mrow" id="MathJax-Span-437"><span class="mfrac" id="MathJax-Span-438"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.37em, 1000.63em, 4.157em, -1000em); top: -4.41em; left: 50%; margin-left: -0.324em;"><span class="mrow" id="MathJax-Span-439"><span class="mi" id="MathJax-Span-440" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="mi" id="MathJax-Span-441" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">c</span></span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; clip: rect(3.359em, 1000.67em, 4.157em, -1000em); top: -3.607em; left: 50%; margin-left: -0.343em;"><span class="mrow" id="MathJax-Span-442"><span class="mi" id="MathJax-Span-443" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="mi" id="MathJax-Span-444" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">b</span></span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; clip: rect(0.858em, 1000.81em, 1.23em, -1000em); top: -1.296em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.807em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.076em;"></span></span></span></span><span class="mo" id="MathJax-Span-445" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-446" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.313em;">a</span></span><span style="display: inline-block; width: 0px; height: 2.561em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.547em; border-left: 0px solid; width: 0px; height: 1.69em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>c</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>b</mi></mrow></mfrac><mo>=</mo><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-37">\frac{\partial c}{\partial b} = a</script>.
 The multiplication operator acts as a magnitude/gradient “swap” that 
magnifies the gradient by the other value’s magnitude. This makes sense -
 if the current value is a result of a multiplication operation and it 
grows, the final value grows proportionally to <em>what it’s multiplied by</em>. The final graph looks like this:</p>

<center>
<p>
    <img src="Backpropagation%20-%20re-writing%20Micrograd%20Will%20Beckman%20blog_files/computational_graph_grad_1_2.png" alt="">
</p>
</center>

<p>The full operations that are happening here is <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-38-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1.0&lt;/mn&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;2.0&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-447" style="width: 10.71em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.76em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.51em, 1008.74em, 3.113em, -1000em); top: -2.561em; left: 0em;"><span class="mrow" id="MathJax-Span-448"><span class="mfrac" id="MathJax-Span-449"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.359em, 1000.67em, 4.159em, -1000em); top: -4.411em; left: 50%; margin-left: -0.343em;"><span class="mrow" id="MathJax-Span-450"><span class="mi" id="MathJax-Span-451" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.019em;"></span></span><span class="mi" id="MathJax-Span-452" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">c</span></span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; clip: rect(3.359em, 1000.67em, 4.159em, -1000em); top: -3.607em; left: 50%; margin-left: -0.343em;"><span class="mrow" id="MathJax-Span-453"><span class="mi" id="MathJax-Span-454" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.019em;"></span></span><span class="mi" id="MathJax-Span-455" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">c</span></span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; clip: rect(0.858em, 1000.81em, 1.23em, -1000em); top: -1.296em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.807em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.076em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-456"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.37em, 1000.63em, 4.157em, -1000em); top: -4.41em; left: 50%; margin-left: -0.324em;"><span class="mrow" id="MathJax-Span-457"><span class="mi" id="MathJax-Span-458" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="mi" id="MathJax-Span-459" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">c</span></span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; clip: rect(3.37em, 1000.67em, 4.157em, -1000em); top: -3.617em; left: 50%; margin-left: -0.344em;"><span class="mrow" id="MathJax-Span-460"><span class="mi" id="MathJax-Span-461" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="mi" id="MathJax-Span-462" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">a</span></span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; clip: rect(0.858em, 1000.81em, 1.23em, -1000em); top: -1.296em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.807em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.076em;"></span></span></span></span><span class="mo" id="MathJax-Span-463" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="mn" id="MathJax-Span-464" style="font-family: STIXGeneral; padding-left: 0.313em;">1.0</span><span class="mo" id="MathJax-Span-465" style="font-family: STIXGeneral; padding-left: 0.25em;">∗</span><span class="mi" id="MathJax-Span-466" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.25em;">b</span><span class="mo" id="MathJax-Span-467" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="mn" id="MathJax-Span-468" style="font-family: STIXGeneral; padding-left: 0.313em;">2.0</span></span><span style="display: inline-block; width: 0px; height: 2.561em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.548em; border-left: 0px solid; width: 0px; height: 1.707em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi>d</mi><mi>c</mi></mrow><mrow><mi>d</mi><mi>c</mi></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>c</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>a</mi></mrow></mfrac><mo>=</mo><mn>1.0</mn><mo>∗</mo><mi>b</mi><mo>=</mo><mn>2.0</mn></math></span></span><script type="math/tex" id="MathJax-Element-38">\frac{d c}{d c}\frac{\partial c}{\partial a} = 1.0 * b = 2.0</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-39-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1.0&lt;/mn&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1.0&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-469" style="width: 10.71em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.76em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.51em, 1008.74em, 3.113em, -1000em); top: -2.561em; left: 0em;"><span class="mrow" id="MathJax-Span-470"><span class="mfrac" id="MathJax-Span-471"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.359em, 1000.67em, 4.159em, -1000em); top: -4.411em; left: 50%; margin-left: -0.343em;"><span class="mrow" id="MathJax-Span-472"><span class="mi" id="MathJax-Span-473" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.019em;"></span></span><span class="mi" id="MathJax-Span-474" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">c</span></span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; clip: rect(3.359em, 1000.67em, 4.159em, -1000em); top: -3.607em; left: 50%; margin-left: -0.343em;"><span class="mrow" id="MathJax-Span-475"><span class="mi" id="MathJax-Span-476" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.019em;"></span></span><span class="mi" id="MathJax-Span-477" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">c</span></span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; clip: rect(0.858em, 1000.81em, 1.23em, -1000em); top: -1.296em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.807em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.076em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-478"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.37em, 1000.63em, 4.157em, -1000em); top: -4.41em; left: 50%; margin-left: -0.324em;"><span class="mrow" id="MathJax-Span-479"><span class="mi" id="MathJax-Span-480" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="mi" id="MathJax-Span-481" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">c</span></span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; clip: rect(3.359em, 1000.67em, 4.157em, -1000em); top: -3.607em; left: 50%; margin-left: -0.343em;"><span class="mrow" id="MathJax-Span-482"><span class="mi" id="MathJax-Span-483" style="font-size: 70.7%; font-family: STIXGeneral;">∂</span><span class="mi" id="MathJax-Span-484" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">b</span></span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; clip: rect(0.858em, 1000.81em, 1.23em, -1000em); top: -1.296em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.807em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.076em;"></span></span></span></span><span class="mo" id="MathJax-Span-485" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="mn" id="MathJax-Span-486" style="font-family: STIXGeneral; padding-left: 0.313em;">1.0</span><span class="mo" id="MathJax-Span-487" style="font-family: STIXGeneral; padding-left: 0.25em;">∗</span><span class="mi" id="MathJax-Span-488" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.25em;">a</span><span class="mo" id="MathJax-Span-489" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="mn" id="MathJax-Span-490" style="font-family: STIXGeneral; padding-left: 0.313em;">1.0</span></span><span style="display: inline-block; width: 0px; height: 2.561em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.548em; border-left: 0px solid; width: 0px; height: 1.707em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi>d</mi><mi>c</mi></mrow><mrow><mi>d</mi><mi>c</mi></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>c</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>b</mi></mrow></mfrac><mo>=</mo><mn>1.0</mn><mo>∗</mo><mi>a</mi><mo>=</mo><mn>1.0</mn></math></span></span><script type="math/tex" id="MathJax-Element-39">\frac{d c}{d c}\frac{\partial c}{\partial b} = 1.0 * a = 1.0</script>, since we are multiplying the “local” gradients of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-40-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-491" style="width: 0.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.512em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.967em, 1000.49em, 2.726em, -1000em); top: -2.561em; left: 0em;"><span class="mrow" id="MathJax-Span-492"><span class="mi" id="MathJax-Span-493" style="font-family: STIXGeneral; font-style: italic;">a</span></span><span style="display: inline-block; width: 0px; height: 2.561em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 0.676em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-40">a</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-41-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-494" style="width: 0.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.512em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.725em, 1000.49em, 2.726em, -1000em); top: -2.561em; left: 0em;"><span class="mrow" id="MathJax-Span-495"><span class="mi" id="MathJax-Span-496" style="font-family: STIXGeneral; font-style: italic;">b</span></span><span style="display: inline-block; width: 0px; height: 2.561em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 0.972em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-41">b</script> by the downstream gradient, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-42-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-497" style="width: 3.537em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.869em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.51em, 1002.76em, 3.113em, -1000em); top: -2.561em; left: 0em;"><span class="mrow" id="MathJax-Span-498"><span class="mfrac" id="MathJax-Span-499"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.359em, 1000.67em, 4.159em, -1000em); top: -4.411em; left: 50%; margin-left: -0.343em;"><span class="mrow" id="MathJax-Span-500"><span class="mi" id="MathJax-Span-501" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.019em;"></span></span><span class="mi" id="MathJax-Span-502" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">c</span></span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; clip: rect(3.359em, 1000.67em, 4.159em, -1000em); top: -3.607em; left: 50%; margin-left: -0.343em;"><span class="mrow" id="MathJax-Span-503"><span class="mi" id="MathJax-Span-504" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.019em;"></span></span><span class="mi" id="MathJax-Span-505" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">c</span></span><span style="display: inline-block; width: 0px; height: 3.996em;"></span></span><span style="position: absolute; clip: rect(0.858em, 1000.81em, 1.23em, -1000em); top: -1.296em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.807em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.076em;"></span></span></span></span><span class="mo" id="MathJax-Span-506" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="mn" id="MathJax-Span-507" style="font-family: STIXGeneral; padding-left: 0.313em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.561em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.548em; border-left: 0px solid; width: 0px; height: 1.707em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi>d</mi><mi>c</mi></mrow><mrow><mi>d</mi><mi>c</mi></mrow></mfrac><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-42">\frac{dc}{dc} = 1</script>. The next computational graph example will make this gradient flow more concrete.</p>

<h3 id="backpropagation">Backpropagation</h3>

<p>Now that you’ve seen how derivatives are computed on a computational 
graph, we can apply these to a specific instance of a computational 
graph - a neural network.</p>

<p>The ultimate goal of a neural network is to make accurate 
predictions. In order to assess how well the network makes predictions, 
we consider a <strong>loss function</strong>, which, given a prediction 
and a true label, rates how close the network was to being correct. If 
the network is performing poorly, the loss will be high, and if the 
network is performing well, the loss will be low. It makes sense that 
the The final output of the network will be this loss function.</p>

<p>If computing gradients, <strong>it’s very important that every operation in a computational graph be differentiable.</strong>
 If an operation is not differentiable, we will not be able to flow the 
gradient backwards through that node. For example, the absolute value 
function is non-differentiable at zero, so we would not be able to use 
it in a computational graph that we are computing gradients for. Since 
the network is composed entirely of differentiable functions, we can 
calculate the derivatives of weights at any depth with respect to the 
loss function.</p>

<p>This gradient computation is really all pytorch and tensorflow are doing, but they are doing it at the level of <em>tensors</em> (i.e. N-D arrays), and they are doing it much more quickly (because it’s parallelized on a GPU).</p>

<p><br></p>

<hr>

<p><br></p>

<p>If you have anything to add, please contact me at will [at] willbeckman [dot] com</p>

<!-- ## Example2


You’ll find this post in your `_posts` directory. Go ahead and edit it and re-build the site to see your changes. You can rebuild the site in many different ways, but the most common way is to run `jekyll serve`, which launches a web server and auto-regenerates your site when a file is updated.

To add new posts, simply add a file in the `_posts` directory that follows the convention `YYYY-MM-DD-name-of-post.ext` and includes the necessary front matter. Take a look at the source for this post to get an idea about how it works.

Jekyll also offers powerful support for code snippets:


<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">def</span> <span class="nf">print_hi</span><span class="p">(</span><span class="nb">name</span><span class="p">)</span>
  <span class="nb">puts</span> <span class="s2">"Hi, </span><span class="si">#{</span><span class="nb">name</span><span class="si">}</span><span class="s2">"</span>
<span class="k">end</span>
<span class="n">print_hi</span><span class="p">(</span><span class="s1">'Tom'</span><span class="p">)</span>
<span class="c1">#=&gt; prints 'Hi, Tom' to STDOUT.</span></code></pre></figure>


Check out the [Jekyll docs][jekyll-docs] for more info on how to get the most out of Jekyll. File all bugs/feature requests at [Jekyll’s GitHub repo][jekyll-gh]. If you have questions, you can ask them on [Jekyll Talk][jekyll-talk].

$$E=mc^2$$

[jekyll-docs]: https://jekyllrb.com/docs/home
[jekyll-gh]:   https://github.com/jekyll/jekyll
[jekyll-talk]: https://talk.jekyllrb.com/ -->

  </div><a class="u-url" href="http://localhost:4000/backprop.html" hidden=""></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Will Beckman blog</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Will Beckman blog</li><li><a class="u-email" href="mailto:will@willbeckman.com">will@willbeckman.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/wbeckman"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">wbeckman</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Posting publicly, but mostly archiving for my future self to revisit.</p>
      </div>
    </div>

  </div>

</footer>



<div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px none; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px none; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-size-adjust: none; font-family: STIXSizeOneSym, sans-serif;"></div></div></body></html>